##############################################################################
Run CD-HIT cluster at 90%:
cdhit-est -i /home/UNIMELB/hdashnow/resistance_database/all_fixed.fsa -o all_fixed_cdhit90 -d 0 > all_fixed_cdhit90.stdout

This script makes the table after clustering and checks for inconsistencies:
res_database_clustering_cdhit.py

##############################################################################
If there are inconsistencies above, you may like to:

Put 90% clusters in individual multi fasta files
http://code.google.com/p/cdhit/source/browse/make_multi_seq.pl
./make_multi_seq.pl ../all_fixed.fsa all_fixed_cdhit90.clstr all90 1 #all clusters in different files
./make_multi_seq.pl ../all_fixed.fsa all_fixed_cdhit90.clstr all90_2 2 #only clusters with 2 or more members in different files
235 clusters contain 2 or more DNA sequences 

This script makes NJ trees for clusters containing at least 3 genes:
align_plot_tree_min3.py

#############################################################################
Once you are happy with your clusters, make a new fasta database with clusters annotated:

The resistance_gene_DB can be used to produce an fasta file formatted for SRST2, using this script: annotate_res_database_clusters.py
New fasta ID format:
>cluster.number__cluster.annotation__original.ID
